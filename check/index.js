//check the status table
//if not locked, lock it with your name
//take top x entries not processed yet
//process them, mark them